# windows11にrails環境を構築する

## 1. linux環境の構築
- [参考](https://www.kagoya.jp/howto/it-glossary/develop/wsl2_linux/)
1. wsl(windows for sub syatem for linux)をインストールする
  - コマンドプロンプトを開き下記コマンドを入力する
  ```
  wsl --install
  ```
  - PCの再起動を行う

2. ubuntuをインストールする
  - Microsoft storeでubuntuを検索し、入手ボタンを押下してインストールする
  - インストール後、ubuntuが開くのでユーザー名とパスワードを入力し、設定する(ユーザー名とパスワードはメモしておくこと)
  
3. Windows Terminalをインストールする
  - Microsoft storeでWindows Terminalを検索し、入手ボタンを押下してインストールする
  - Windows Terminalの設定を開き、規定のファイルをubuntuに設定する
  
## 2. docker環境の構築
- [参考](https://sabakunotabito.hatenablog.com/entry/2021/10/03/024348)
1. aptのバージョン確認
```
sudo apt upadte
sudo apt upgrade

suzukit@agrio___orio:~$ sudo apt upgrade
Reading package lists... Done
Building dependency tree
Reading state information... Done
Calculating upgrade... Done
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
```
2. Dockerに必要なパッケージのインストール
```
sudo apt install -y apt-transport-https ca-certificates gnupg-agent software-properties-common

suzukit@agrio___orio:~$ sudo apt install -y apt-transport-https ca-certificates gnupg-agent software-properties-common
Reading package lists... Done
Building dependency tree
Reading state information... Done
Note, selecting 'apt' instead of 'apt-transport-https'
Note, selecting 'gpg-agent' instead of 'gnupg-agent'
apt is already the newest version (2.0.2).
apt set to manually installed.
ca-certificates is already the newest version (20190110ubuntu1).
ca-certificates set to manually installed.
gpg-agent is already the newest version (2.2.19-3ubuntu2).
gpg-agent set to manually installed.
software-properties-common is already the newest version (0.98.9).
software-properties-common set to manually installed.
0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.
```

3. Dockerの公式GPGキーの取得と確認
```
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
sudo apt-key fingerprint 0EBFCD88

suzukit@agrio___orio:~$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
OK
suzukit@agrio___orio:~$ sudo apt-key fingerprint 0EBFCD88
pub   rsa4096 2017-02-22 [SCEA]
      9DC8 5822 9FC7 DD38 854A  E2D8 8D81 803C 0EBF CD88
uid           [ unknown] Docker Release (CE deb) <docker@docker.com>
sub   rsa4096 2017-02-22 [S]
```

4. リポジトリの設定を行う
```
$ sudo add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"

suzukit@agrio___orio:~$ sudo add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"
Get:1 https://download.docker.com/linux/ubuntu focal InRelease [57.7 kB]
Get:2 https://download.docker.com/linux/ubuntu focal/stable amd64 Packages [16.7 kB]
Get:3 http://security.ubuntu.com/ubuntu focal-security InRelease [114 kB]
Get:4 http://archive.ubuntu.com/ubuntu focal InRelease [265 kB]
Get:5 http://security.ubuntu.com/ubuntu focal-security/main amd64 Packages [1453 kB]
Get:6 http://archive.ubuntu.com/ubuntu focal-updates InRelease [114 kB]
Get:7 http://security.ubuntu.com/ubuntu focal-security/main Translation-en [250 kB]
Get:8 http://security.ubuntu.com/ubuntu focal-security/main amd64 c-n-f Metadata [10.2 kB]
Get:9 http://security.ubuntu.com/ubuntu focal-security/restricted amd64 Packages [914 kB]
Get:10 http://archive.ubuntu.com/ubuntu focal-backports InRelease [108 kB]
Get:11 http://security.ubuntu.com/ubuntu focal-security/restricted Translation-en [130 kB]
Get:12 http://security.ubuntu.com/ubuntu focal-security/restricted amd64 c-n-f Metadata [520 B]
Get:13 http://security.ubuntu.com/ubuntu focal-security/universe amd64 Packages [703 kB]
Get:14 http://security.ubuntu.com/ubuntu focal-security/universe Translation-en [125 kB]
Get:15 http://security.ubuntu.com/ubuntu focal-security/universe amd64 c-n-f Metadata [14.5 kB]
Get:16 http://security.ubuntu.com/ubuntu focal-security/multiverse amd64 Packages [22.2 kB]
Get:17 http://security.ubuntu.com/ubuntu focal-security/multiverse Translation-en [5376 B]
Get:18 http://security.ubuntu.com/ubuntu focal-security/multiverse amd64 c-n-f Metadata [512 B]
Get:19 http://archive.ubuntu.com/ubuntu focal/main amd64 Packages [970 kB]
Get:20 http://archive.ubuntu.com/ubuntu focal/main Translation-en [506 kB]
Get:21 http://archive.ubuntu.com/ubuntu focal/main amd64 c-n-f Metadata [29.5 kB]
Get:22 http://archive.ubuntu.com/ubuntu focal/universe amd64 Packages [8628 kB]
Get:23 http://archive.ubuntu.com/ubuntu focal/universe Translation-en [5124 kB]
Get:24 http://archive.ubuntu.com/ubuntu focal/universe amd64 c-n-f Metadata [265 kB]
Get:25 http://archive.ubuntu.com/ubuntu focal/multiverse amd64 Packages [144 kB]
Get:26 http://archive.ubuntu.com/ubuntu focal/multiverse Translation-en [104 kB]
Get:27 http://archive.ubuntu.com/ubuntu focal/multiverse amd64 c-n-f Metadata [9136 B]
Get:28 http://archive.ubuntu.com/ubuntu focal-updates/main amd64 Packages [1793 kB]
Get:29 http://archive.ubuntu.com/ubuntu focal-updates/main Translation-en [330 kB]
Get:30 http://archive.ubuntu.com/ubuntu focal-updates/main amd64 c-n-f Metadata [15.2 kB]
Get:31 http://archive.ubuntu.com/ubuntu focal-updates/restricted amd64 Packages [976 kB]
Get:32 http://archive.ubuntu.com/ubuntu focal-updates/restricted Translation-en [139 kB]
Get:33 http://archive.ubuntu.com/ubuntu focal-updates/restricted amd64 c-n-f Metadata [520 B]
Get:34 http://archive.ubuntu.com/ubuntu focal-updates/universe amd64 Packages [924 kB]
Get:35 http://archive.ubuntu.com/ubuntu focal-updates/universe Translation-en [207 kB]
Get:36 http://archive.ubuntu.com/ubuntu focal-updates/universe amd64 c-n-f Metadata [20.7 kB]
Get:37 http://archive.ubuntu.com/ubuntu focal-updates/multiverse amd64 Packages [24.4 kB]
Get:38 http://archive.ubuntu.com/ubuntu focal-updates/multiverse Translation-en [7336 B]
Get:39 http://archive.ubuntu.com/ubuntu focal-updates/multiverse amd64 c-n-f Metadata [596 B]
Get:40 http://archive.ubuntu.com/ubuntu focal-backports/main amd64 Packages [68.1 kB]
Get:41 http://archive.ubuntu.com/ubuntu focal-backports/main Translation-en [10.9 kB]
Get:42 http://archive.ubuntu.com/ubuntu focal-backports/main amd64 c-n-f Metadata [980 B]
Get:43 http://archive.ubuntu.com/ubuntu focal-backports/restricted amd64 c-n-f Metadata [116 B]
Get:44 http://archive.ubuntu.com/ubuntu focal-backports/universe amd64 Packages [26.8 kB]
Get:45 http://archive.ubuntu.com/ubuntu focal-backports/universe Translation-en [15.9 kB]
Get:46 http://archive.ubuntu.com/ubuntu focal-backports/universe amd64 c-n-f Metadata [860 B]
Get:47 http://archive.ubuntu.com/ubuntu focal-backports/multiverse amd64 c-n-f Metadata [116 B]
Fetched 24.6 MB in 6s (3929 kB/s)
Reading package lists... Done
```

5. Dockerのインストール
```
$ sudo apt update
$ sudo apt install -y docker-ce docker-ce-cli containerd.io
$ docker --version

suzukit@agrio___orio:~$ sudo apt update
Hit:1 https://download.docker.com/linux/ubuntu focal InRelease
Hit:2 http://archive.ubuntu.com/ubuntu focal InRelease
Hit:3 http://security.ubuntu.com/ubuntu focal-security InRelease
Hit:4 http://archive.ubuntu.com/ubuntu focal-updates InRelease
Hit:5 http://archive.ubuntu.com/ubuntu focal-backports InRelease
Reading package lists... Done
Building dependency tree
Unpacking docker-ce-cli (5:20.10.16~3-0~ubuntu-focal) ...
Selecting previously unselected package docker-ce.
Preparing to unpack .../2-docker-ce_5%3a20.10.16~3-0~ubuntu-focal_amd64.deb ...
Unpacking docker-ce (5:20.10.16~3-0~ubuntu-focal) ...
Selecting previously unselected package docker-ce-rootless-extras.
Preparing to unpack .../3-docker-ce-rootless-extras_5%3a20.10.16~3-0~ubuntu-focal_amd64.deb ...
Unpacking docker-ce-rootless-extras (5:20.10.16~3-0~ubuntu-focal) ...
Selecting previously unselected package docker-scan-plugin.
Preparing to unpack .../4-docker-scan-plugin_0.17.0~ubuntu-focal_amd64.deb ...
Unpacking docker-scan-plugin (0.17.0~ubuntu-focal) ...
Selecting previously unselected package slirp4netns.
Preparing to unpack .../5-slirp4netns_0.4.3-1_amd64.deb ...
Unpacking slirp4netns (0.4.3-1) ...
Setting up slirp4netns (0.4.3-1) ...
Setting up docker-scan-plugin (0.17.0~ubuntu-focal) ...
Setting up containerd.io (1.6.4-1) ...
Created symlink /etc/systemd/system/multi-user.target.wants/containerd.service → /lib/systemd/system/containerd.service.
Setting up docker-ce-cli (5:20.10.16~3-0~ubuntu-focal) ...
Setting up pigz (2.4-1) ...
Setting up docker-ce-rootless-extras (5:20.10.16~3-0~ubuntu-focal) ...
Setting up docker-ce (5:20.10.16~3-0~ubuntu-focal) ...
Created symlink /etc/systemd/system/multi-user.target.wants/docker.service → /lib/systemd/system/docker.service.
Created symlink /etc/systemd/system/sockets.target.wants/docker.socket → /lib/systemd/system/docker.socket.
invoke-rc.d: could not determine current runlevel
Processing triggers for systemd (245.4-4ubuntu3) ...
Processing triggers for man-db (2.9.1-1) ...
Processing triggers for libc-bin (2.31-0ubuntu9) ...
suzukit@agrio___orio:~$ docker --version
Docker version 20.10.16, build aa7e414
```
6. composeのバージョンアップ
- バージョン確認
```
apt list | grep docker-compose

suzukit@agrio___orio:~$ apt list | grep docker-compose
WARNING: apt does not have a stable CLI interface. Use with caution in scripts.
docker-compose-plugin/focal 2.5.0~ubuntu-focal amd64
docker-compose/focal 1.25.0-1 all
```
- バージョンがdocker-compose/focal 1.25.0-1 allと表示されていたらそのまま下記コマンドを実行してdocker-composeをインストール
```
sudo apt install docker-compose
docker-compose --version
```

7. dockerの起動、確認
```
suzukit@agrio___orio:~$ sudo service docker start
 * Starting Docker: docker                                                                                       [ OK ]
suzukit@agrio___orio:~$ service docker status
 * Docker is running
 ```
 
 8. dockerの動作確認
 ```
 suzukit@agrio___orio:~$ sudo docker run hello-world
Unable to find image 'hello-world:latest' locally
latest: Pulling from library/hello-world
2db29710123e: Pull complete
Digest: sha256:80f31da1ac7b312ba29d65080fddf797dd76acfb870e677f390d5acba9741b17
Status: Downloaded newer image for hello-world:latest

Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.
    (amd64)
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker ID:
 https://hub.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/get-started/
```
- dockerサービスのコマンド一覧と停止
```
suzukit@agrio___orio:~$ sudo service docker help
Usage: service docker {start|stop|restart|status}
suzukit@agrio___orio:~$ sudo service docker stop
 * Stopping Docker: docker

## 2.5. git
```
suzukit@agrio___orio:~$ git --version
git version 2.25.1
```

## 3. 
